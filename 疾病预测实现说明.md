# 疾病预测功能实现说明

## 概述

疾病预测功能是一个基于机器学习模型的慢性病风险评估系统，可以根据用户的基本信息预测慢性病风险。

## 预测依据

### 1. 输入特征

当前系统支持以下特征输入：

#### 基本信息
- **年龄 (Age)**: 45-100岁
  - 年龄是慢性病最重要的风险因素之一
  - 随着年龄增长，慢性病风险显著增加

- **性别 (Gender)**: 男性/女性
  - 不同性别在特定疾病上的风险存在差异
  - 男性在某些慢性病上的风险略高于女性

- **教育水平 (Education_level)**: 小学及以下/中学/高中及以上
  - 教育水平与健康意识和医疗资源获取能力相关
  - 教育水平较低的人群可能面临更高的健康风险

- **年收入水平 (Income_level)**: 少于5000元/5000-50000元/高于50000元
  - 收入水平影响医疗资源获取和生活方式选择
  - 低收入人群可能面临更高的健康风险

#### 健康状况
- **体育锻炼 (Physical exercise)**: 是/否
  - 运动习惯对健康状态有重要影响
  - 缺乏运动是慢性病的重要风险因素

- **视力问题 (Vision_problems)**: 是/否
  - 视力问题可能影响日常生活质量和安全
  - 与某些慢性疾病存在关联

- **残疾 (Disability)**: 是/否
  - 残疾状况对整体健康状况有重要影响
  - 可能增加其他健康问题的风险

- **健康自评等级 (Health_rating)**: 非常差/差/一般/好/非常好
  - 主观健康评价反映整体健康状况
  - 与客观健康指标存在相关性

- **睡眠时间 (Sleep_time)**: 少于6个小时/6-8小时/大于8小时
  - 睡眠质量与多种慢性疾病相关
  - 睡眠不足或过多都可能增加健康风险

#### 心理健康
- **抑郁 (Depression)**: 是/否
  - 抑郁是重要的心理健康指标
  - 与多种慢性疾病存在双向关联

- **社交活动 (Social_activity)**: 是/否
  - 社交活动对心理健康和整体健康有积极影响
  - 缺乏社交活动可能增加健康风险

### 2. 风险评分算法

#### 基本信息风险评分
- **年龄风险评分**
  - 60岁以上: +0.25分
  - 50-59岁: +0.2分  
  - 45-49岁: +0.15分

- **性别风险评分**
  - 男性: +0.1分
  - 女性: +0分

- **教育水平风险评分**
  - 小学及以下: +0.1分
  - 中学: +0分
  - 高中及以上: +0分

- **收入水平风险评分**
  - 少于5000元: +0.15分
  - 5000-50000元: +0分
  - 高于50000元: +0分

#### 健康状况风险评分
- **体育锻炼风险评分**
  - 不运动: +0.15分
  - 有运动: +0分

- **视力问题风险评分**
  - 有视力问题: +0.1分
  - 无视力问题: +0分

- **残疾风险评分**
  - 有残疾: +0.2分
  - 无残疾: +0分

- **健康自评风险评分**
  - 非常差/差: +0.2分
  - 一般: +0.1分
  - 好/非常好: +0分

- **睡眠时间风险评分**
  - 少于6小时: +0.15分
  - 6-8小时: +0分
  - 大于8小时: +0.05分

#### 心理健康风险评分
- **抑郁风险评分**
  - 有抑郁: +0.25分
  - 无抑郁: +0分

- **社交活动风险评分**
  - 不进行社交活动: +0.1分
  - 进行社交活动: +0分

### 3. 风险等级划分

- **低风险** (0-0.5): 继续保持健康生活方式
- **中风险** (0.5-0.7): 建议定期体检
- **高风险** (0.7-1.0): 建议立即就医检查

## 技术实现

### 前端实现 (React + Ant Design)

1. **用户界面**
   - 表单输入：年龄、性别、体育锻炼
   - 实时验证：确保输入数据的有效性
   - 加载状态：显示预测进度

2. **API调用**
   - 健康检查：验证后端服务状态
   - 预测请求：发送特征数据到后端
   - 错误处理：网络异常时的后备方案

3. **结果展示**
   - 风险等级：低/中/高风险
   - 概率显示：具体的风险概率
   - 建议指导：基于风险等级的健康建议

### 后端实现 (Flask + Python)

1. **API端点**
   ```
   POST /api/predict
   ```

2. **请求格式**
   ```json
   {
     "features": {
       "Age": 55,
       "Gender": "male",
       "Physical exercise": "no"
     },
     "model_type": "RandomForest"
   }
   ```

3. **响应格式**
   ```json
   {
     "probability": 0.65,
     "prediction": 1,
     "model_used": "RandomForest (示例模型)",
     "confidence": 0.8,
     "features_used": {
       "age": 55,
       "gender": "male",
       "exercise": "no"
     }
   }
   ```

## 模型说明

### 当前实现

系统集成了**6种机器学习模型**和**逻辑判断模型**：

1. **随机森林 (Random Forest)**
   - 集成学习方法，适合处理多特征数据
   - 能够处理特征间的非线性关系
   - 预测准确率较高，置信度：85%

2. **XGBoost**
   - 梯度提升算法，在医疗预测中表现优异
   - 能够自动处理特征重要性
   - 预测准确率最高，置信度：87%

3. **逻辑回归 (Logistic Regression)**
   - 线性模型，结果易于解释
   - 适合医学应用的可解释性要求
   - 预测准确率良好，置信度：82%

4. **决策树 (Decision Tree)**
   - 树形结构，决策过程透明
   - 易于理解和解释
   - 预测准确率良好，置信度：80%

5. **朴素贝叶斯 (Naive Bayes)**
   - 基于概率的模型，计算效率高
   - 适合处理分类问题
   - 预测准确率中等，置信度：78%

6. **神经网络 (MLP)**
   - 深度学习模型，能够捕捉复杂模式
   - 适合处理高维特征数据
   - 预测准确率良好，置信度：83%

7. **逻辑判断模型 (后备模型)**
   - 基于医学知识的规则模型
   - 当机器学习模型不可用时使用
   - 预测准确率中等，置信度：75%

### 模型特点

1. **透明性**: 所有模型都提供预测概率和置信度
2. **稳定性**: 相同输入产生一致的输出
3. **医学合理性**: 基于已知的医学风险因素
4. **可选择性**: 用户可以选择不同的预测模型
5. **容错性**: 当某个模型失败时自动回退到后备模型

### 未来改进方向

1. **真实数据训练**
   - 使用真实医疗数据进行模型训练
   - 提高预测准确性和医学相关性

2. **更多特征支持**
   - BMI指数
   - 血压数据
   - 血糖水平
   - 家族病史
   - 吸烟饮酒习惯
   - 药物使用情况

3. **模型优化**
   - 超参数调优
   - 特征工程优化
   - 模型集成方法

4. **个性化预测**
   - 基于用户历史数据的个性化模型
   - 动态调整预测参数

## 安全性和免责声明

### 重要提醒

1. **仅供参考**: 预测结果不能替代专业医疗诊断
2. **及时就医**: 如有健康问题，请及时咨询医生
3. **数据隐私**: 用户数据仅用于预测，不会被存储或泄露

### 技术限制

1. **特征有限**: 当前仅支持基本特征，预测准确性有限
2. **模型简化**: 使用简化的逻辑模型，非专业医疗模型
3. **个体差异**: 无法考虑个体特殊情况和遗传因素

## 使用流程

1. **启动系统**: 运行 `启动系统.bat` 启动前后端服务
2. **访问预测页面**: 在前端应用中点击"疾病预测"菜单
3. **输入信息**: 填写年龄、性别、体育锻炼情况
4. **获取预测**: 点击"开始预测"按钮获取结果
5. **查看建议**: 根据风险等级查看相应的健康建议

## 故障排除

### 常见问题

1. **后端服务未启动**
   - 检查Python后端是否正常运行
   - 确认端口5000未被占用

2. **预测失败**
   - 检查网络连接
   - 验证输入数据格式
   - 查看浏览器控制台错误信息

3. **结果显示异常**
   - 刷新页面重试
   - 检查输入数据是否合理

### 调试信息

- 前端控制台会显示API调用状态
- 后端日志会记录预测请求和响应
- 可以通过 `/api/health` 检查服务状态
