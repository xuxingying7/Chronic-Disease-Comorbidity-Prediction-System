# 故障排除指南

## Python依赖安装失败

### 问题描述
启动系统时出现"依赖包安装失败"错误。

### 解决方案

#### 方案1：使用手动安装工具
1. 双击运行 `手动安装依赖.bat`
2. 选择安装方式：
   - 推荐选择 **2** (清华镜像) 或 **3** (阿里云镜像)
   - 如果仍然失败，选择 **4** (系统环境安装)

#### 方案2：手动命令行安装
打开命令提示符，执行以下命令：

```bash
# 进入backend目录
cd backend

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
venv\Scripts\activate.bat

# 升级pip
pip install --upgrade pip

# 使用清华镜像安装
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ -r requirements.txt
```

#### 方案3：分步安装
如果整体安装失败，可以分步安装：

```bash
cd backend
python -m venv venv
venv\Scripts\activate.bat
pip install --upgrade pip

# 逐个安装核心包
pip install flask==3.0.3
pip install flask-cors==4.0.1
pip install pandas==2.2.2
pip install numpy==1.26.4
pip install scikit-learn==1.4.2
pip install openpyxl==3.1.2

# 可选：安装xgboost（如果失败可以跳过）
pip install xgboost==2.0.3
```

#### 方案4：使用最小化依赖
如果某些包安装困难，可以使用最小化版本：

```bash
cd backend
python -m venv venv
venv\Scripts\activate.bat
pip install --upgrade pip
pip install -r requirements-minimal.txt
```

### 常见错误及解决方法

#### 1. "Microsoft Visual C++ 14.0 is required"
**错误原因**：某些Python包需要编译，缺少Visual C++编译器

**解决方法**：
- 安装Visual Studio Build Tools
- 或使用预编译的wheel包：
  ```bash
  pip install --only-binary=all -r requirements.txt
  ```

#### 2. "Permission denied"
**错误原因**：权限不足

**解决方法**：
- 以管理员身份运行命令提示符
- 或使用用户安装：
  ```bash
  pip install --user -r requirements.txt
  ```

#### 3. "Network timeout"
**错误原因**：网络连接问题

**解决方法**：
- 使用国内镜像源
- 增加超时时间：
  ```bash
  pip install --timeout 1000 -r requirements.txt
  ```

#### 4. "xgboost安装失败"
**解决方法**：
- 跳过xgboost安装，系统仍可正常运行
- 或使用conda安装：
  ```bash
  conda install xgboost
  ```

### 验证安装

安装完成后，验证是否成功：

```bash
cd backend
venv\Scripts\activate.bat
python -c "import flask, pandas, numpy, sklearn; print('所有依赖安装成功！')"
```

### 启动系统

依赖安装成功后，可以启动系统：

1. **完整启动**：双击 `启动系统.bat`
2. **仅前端**：双击 `start.bat`
3. **手动启动**：
   ```bash
   # 启动后端
   cd backend
   venv\Scripts\activate.bat
   python app.py
   
   # 启动前端（新窗口）
   cd web
   npm start
   ```

### 获取帮助

如果问题仍然存在：
1. 检查Python版本（需要3.8+）
2. 检查网络连接
3. 尝试不同的镜像源
4. 查看详细的错误信息

### 系统要求

- **Python**: 3.8 或更高版本
- **Node.js**: 14.0 或更高版本
- **内存**: 建议4GB以上
- **网络**: 需要下载依赖包
